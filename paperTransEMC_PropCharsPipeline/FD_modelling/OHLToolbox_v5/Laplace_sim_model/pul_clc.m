function [g,Z,Y,Ti,freq]=pul_clc(ord,num_files)
%%
filedata_Z=importdata('fbatchZ.txt'); % Input file for Z - ????????? ?? ?? ??????? ????????? ?????????? ?
%filedata_Y=importdata('fbatchY_Sunde.txt'); % Input file for Y - ????????? ?? ?? ??????? ????????? ?????????? ? 
filedata_Y=importdata('fbatchY_Prop.txt'); % Input file for Y - ????????? ?? ?? ??????? ????????? ?????????? ? 
freq=importdata('freq.txt'); % Input file for frequencies - ????????? ?? ??? ???????? ?????????? f

%filedata_Zskin=importdata('fbatchZskin.txt'); % Extra - ???????? ?????????!!! - Input file for Zskin - ????????? ?? ?? ??????? ????????? ?????????? ?skin

path='E:\website_software\Laplace_sim_model_original'; % Main path
path_Z=strcat(path,'\Z'); % Path for Z values - Theofilos's or Sunde's model
path_Y=strcat(path,'\Y'); % Path for Y values - Theofilos's or Sunde's model

Z=zeros(num_files,ord^2); % (num_files x ord^2)
Y=zeros(num_files,ord^2); % (num_files x ord^2)

%% 
% Parsing and building files

for k=1:1:num_files 
    
    cd(path_Z); % ?????? ??? directory ??? ?????? ?
    Ztmp=parse_matrix(k,filedata_Z,ord); % Function parse_matrix sto path_Z!!

    cd(path_Y); % ?????? ??? directory ??? ?????? ?
    Ytmp=parse_matrix(k,filedata_Y,ord); % Function parse_matrix sto path_Y!!
     
    cd(path); % ?????? ??? directory ??? ?????? path
    [Zdis,Ydis]=zyph_param(Ztmp,Ytmp,ord); % Function zyph_param - ?????????? ?? ?' ??? ?' ??? ??? ???????? ????????? ??? ??? num_files - (ord x ord) ??? ?? 2
             
    %Ydis=calc_Y_Ametani_1ph(freq(k)); % Extra - ???????? ?????????!! - ?' ?? ???? ????? Ametani ??? 1ph ??????? ???? ????????? ??? ???!! ??? ??? ???????? ????????? ??? ??? num_files - (ord x ord) 
    %Ydis=calc_Y_Ametani_3ph(freq(k)); % Extra - ???????? ?????????!! - ?' ?? ???? ????? Ametani ??? 3ph ??????? ?? flat ??????? ???? ????????? ??? ???!! ??? ??? ???????? ????????? ??? ??? num_files - (ord x ord) 
    
    for o=1:ord
        Z(k,(o-1)*ord+1:o*ord)=Zdis(o,:); % ?????????? ???? ??? ?' ??? ???????? ????????? - (num_files x ord^2)
        Y(k,(o-1)*ord+1:o*ord)=Ydis(o,:); % ?????????? ???? ??? Y' ??? ???????? ????????? - (num_files x ord^2)
    end
end

%% Calculation of Ti & g

[Ti,g]=NR_calc_norm_str(ord,num_files,Z,Y,freq); % ????????? Newton-Raphson ?? seeding ??????????? ??? ?????????? ??? ??????? ?? eigenvector switchover - ?????????? ?????? ??????????????? Ti (current) (num_files x ord^2) ??? ????????? g (sqrt) (num_files x ord)

%[Ti,g]=LM_calc_norm_str(ord,num_files,Z,Y,freq); % ????????? Levenberg-Marquardt ?? seeding ??????????? ??? ?????????? ??? ??????? ?? eigenvector switchover - ?????????? ?????? ??????????????? Ti (current) (num_files x ord^2) ??? ????????? g (sqrt) (num_files x ord)

% for k=1:1:num_files % JMarti-like model (TEST ?)
%     Ti(k,:)=real(Ti(81,:));
% end
