function [V]=freq_scan_sim(ord,gamma_dis,Z_dis,Y_dis,Ti_dis,freq,Ys_dis,Yr_dis,length_line)

Vo1=ones(1,max(size(freq)));

gamma=gamma_dis;
Z=Z_dis;
Y=Y_dis;
Ti=Ti_dis;
Ys=Ys_dis;
Yr=Yr_dis;

Ybranch=zeros(max(size(freq)),(2*ord)^2); % (num_files x (2*ord)^2)   

for o=1:1:max(size(freq))
    %Ybranch_dis=get_Ybranch(ord,length,Ti(o,:),Ys(o,:),Yr(o,:),gamma(o,:),Z(o,:)); % Function get_Ybranch - ?????????? ?? ???????? ?????? ???????????? ??? ???????? ??? ???? ??? ???????? ????????? - (1 x (2*ord)^2)
    Ybranch_dis=get_Ybranch_scaled(ord,length_line,Ti(o,:),Ys(o,:),Yr(o,:),gamma(o,:),Z(o,:)); % Function get_Ybranch - ?????????? ?? ???????? ?????? ???????????? ??? ???????? ??? ???? ??? ???????? ????????? - (1 x (2*ord)^2)
          
    Ybranch(o,:)=Ybranch_dis; % ?????????? ???? ??? Ybranch_dis ??? ???????? ????????? - (num_files x (2*ord)^2)
end

%% Frequency Domain Calculation
V=calc_Vnode(ord,freq,Ybranch,Vo1); % Function calc_Vnode - ??????????? ??? ??????????? ??? ?????? ?? ????? ???? ??????? ??? ????? ??? ?????????? (S ??? R) - (2*ord x max(size(f)))

%% Plot
Vmag=abs(V);
% norm=1;
% subplot(2,1,1)
% semilogx(freq,Vmag(1,:)./norm,'k',freq,Vmag(2,:)./norm,'r',freq,Vmag(3,:)./norm,'g');
% xlabel('frequency (Hz)')
% ylabel('Signal (V)')
% legend('#1','#2','#3')%,'#4','#5','#6')
% title('Sending end')
% subplot(2,1,2)
% semilogx(freq,Vmag(4,:)./norm,'k',freq,Vmag(5,:)./norm,'r',freq,Vmag(6,:)./norm,'g');
% xlabel('frequency (Hz)')
% ylabel('Signal (V)')
% legend('#1','#2','#3');%,'#4','#5','#6')
% title('Receiving end')

for o=1:1:2*ord
    %Vmag(:,o)=0;
    figure(o)
    semilogx(freq,Vmag(o,:));
    xlabel('frequency (Hz)')
    ylabel('Signal (V)')
end
